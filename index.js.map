{"version":3,"sources":["index.js"],"names":["isFunc","source","dispatchBaker","dispatch","bakerArgs","args","overrideComponent","component","actionsDict","_view","view","vnode","_vnode","processActions","actions","toReturn","key","buildContainer","setup","store","mithril","_store","_m","defaultContainer","provider","rootComponent","container","on","redraw","connect","selector","Component","a","children","get","state","undefined","_component","module","exports"],"mappings":"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","file":"index.js","sourceRoot":"src","sourcesContent":["const isFunc = source => typeof source === \"function\";\r\n\r\nconst dispatchBaker = (source, dispatch) => (...bakerArgs) => (...args) =>\r\n  dispatch(source(...bakerArgs, ...args));\r\n\r\nconst overrideComponent = (component, actionsDict) => {\r\n  const _view = component.view;\r\n  component.view = (vnode, ...args) => {\r\n    const _vnode = { ...vnode, ...actionsDict };\r\n    return _view(_vnode, ...args);\r\n  };\r\n};\r\n\r\nconst processActions = (actions, dispatch) => {\r\n  if (isFunc(actions) === true) {\r\n    return actions(dispatch);\r\n  } else if (typeof actions === \"object\") {\r\n    let toReturn = {};\r\n    for (key in actions) {\r\n      if (isFunc(actions[key])) {\r\n        toReturn[key] = dispatchBaker(actions[key], dispatch);\r\n      }\r\n    }\r\n    return toReturn;\r\n  }\r\n  return {};\r\n};\r\n\r\nfunction buildContainer() {\r\n  return {\r\n    setup: function(store, mithril) {\r\n      this._store = store;\r\n      this._m = mithril;\r\n    },\r\n    ...this\r\n  };\r\n}\r\n\r\nconst defaultContainer = new buildContainer();\r\n\r\nconst provider = (rootComponent, container = defaultContainer) => {\r\n  const { _store, _m } = container;\r\n  _store.on(\"@changed\", _m.redraw);\r\n  return isFunc(rootComponent) ? new rootComponent() : rootComponent;\r\n};\r\n\r\nconst connect = (\r\n  selector,\r\n  actions,\r\n  container = defaultContainer\r\n) => Component => ({\r\n  view(vnode, a, children) {\r\n    const {\r\n      _m,\r\n      _store: { dispatch, get }\r\n    } = container;\r\n    const actionsDict = processActions(actions, dispatch);\r\n    const state = isFunc(selector) ? selector(get()) : undefined;\r\n    const _component = isFunc(Component) ? new Component() : Component;\r\n    overrideComponent(_component, actionsDict);\r\n    return _m(\r\n      _component,\r\n      {\r\n        dispatch,\r\n        ...actionsDict,\r\n        ...a,\r\n        ...state\r\n      },\r\n      children\r\n    );\r\n  }\r\n});\r\n\r\nmodule.exports = {\r\n  buildContainer,\r\n  container: defaultContainer,\r\n  provider,\r\n  connect\r\n};\r\n"]}